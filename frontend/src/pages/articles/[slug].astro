---
import Layout from '../../layouts/Layout.astro'
import StyledMarkdown from '../../components/shared/StyledMarkdown.astro'
import { getCollection } from 'astro:content'

export async function getStaticPaths() {
  const articles = await getCollection('articles')
  return articles.map((article) => ({ params: { slug: article.id } }))
}

const { slug } = Astro.params
const articles = await getCollection('articles')
const article = articles.find((a) => a.id === slug)
if (!article) {
  throw new Error(`Article not found: ${slug}`)
}
const { data, body } = article
---

<Layout title={data.title}>
  <article class='prose bg-zinc-50 mx-auto max-w-5xl py-24'>
    <h1 class='text-3xl font-bold mb-2'>{data.title}</h1>
    {data.date && <p class='text-gray-500 text-sm mb-6'>{data.date}</p>}
    {data.description && <p class='mb-4 text-lg text-emerald-900'>{data.description}</p>}
    <StyledMarkdown of={body ? body : ''} />
  </article>
</Layout>
